<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<link href="css/main.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.8.1.min.js" type="text/javascript"></script>
<link href="css/main.css" rel="stylesheet" type="text/css" />
<title>系统菜单设置</title>
</head>
<style>
a{ color:#000; text-decoration:none;}
*{ margin:0px; padding:0px; font-size:12px;}
.biaotou{background:url(images/tbg.gif) repeat-x; height:28px; line-height:28px;}
.np{ border:none; padding:2px; line-height:20px; height:20px; margin-right:2px;}
dl{ width:30%; float:left; margin-left:10px;}
dt,dd{ padding:0px 20px;display:block; height:30px; line-height:30px;}
dd{ padding-left:40px; border-bottom:dashed 1px #ccc;}
input{ text-align:center; padding:2px;}
.menutable{ margin-bottom:100px;}
table td{ border:none;}
tr{ height:30px; padding:5px; line-height:30px;border:1px dotted #ccc;}
</style>
<body>
<input name="childlanmuurl" type="text"   value="" size="20" />
<table class="menutable" width="98%"  style="border-collapse:collapse;border-color:gray;"border="1"  cellspacing="0" cellpadding="0"> 
  <tr class="biaotou">
    <td align="center" colspan="2">系统设置/菜单
      <input name="sysmenu_link"  type="text"  value="{{menu2_link}}" size="20" />
    管理<span style="color:red;">(此处设置非程序员请勿操作)<a href="javascript:window.history.go(-1);" class="coolbg">返回</a></span></td>
  </tr>
  <tr class="biaotou">
    <td align="left" colspan="2">
    <form name="addlanmuform" id="addlanmuform" action="" method="post" onsubmit="" > 
        <input type="hidden" name="act" value="add" /> 
      后台栏目：<input type="text" name="lanmu"  value="" size="10" />
        &nbsp;
        <a href="javascript:void(0);" onclick="addlanmuform.submit();" class="coolbg">添加</a>
        <input name="sysmenu_name2" type="text"   value="{{menu1_name}}" size="15" />
    </form></td>
  </tr>
<tr align="center" class="biaotou" >
    <td align="left" colspan="2">
     <form name="addchildlanmuform" id="addchildlanmuform" action="" method="post" >  
     <input type="hidden" name="act" value="add" />
    后台栏目：
{{sysmenus}}
    子菜单：
      <input name="childlanmu" type="text"   value="" size="10" />      URL:&nbsp;<a href="javascript:void(0);" onclick="addchildlanmuform.submit();" class="coolbg">添加</a> &nbsp;</form></td>
  </tr>

<tr class="biaotou">
    <td align="center" colspan="2">系统菜单更新/删除</td>
  </tr>
     <!-- BEGIN m1_block -->
  <tr background="images/tbg.gif" class="biaotou">
    <td  width="30%" align="left" style="padding-left:20px;background:none;">一级菜单：（ID:{{menu1_id}}）</td><td>
    <form action="" method="post">
      <input type="hidden" name="act" value="update" />
	<input type="submit" value="更新" id="addchildlanmu"  class="coolbg"/>
    <input type="hidden" name="id" value="{{menu1_id}}" />
	<input type="button" value="删除" id="addchildlanmu"  class="coolbg delbtn"/>
     排序:<input type="text" class="sort" value="{{sort1}}" size="3" maxlength="2"   />
    </form></td>
  </tr>
    <!-- BEGIN m2_block -->
    <tr>
    <td align="left" style="padding-left:50px;"> 子菜单：（ID:{{menu2_id}}）</td><td>
    <form action="" method="post">
       <input name="sysmenu_name"  type="text"  value="{{menu2_name}}" size="15" /> 
    URL:
    <input type="hidden" name="act" value="update" />
	<input type="submit" value="更新" id="addchildlanmu"  class="coolbg"/>
    <input type="hidden" name="id" value="{{menu2_id}}" />
	<input type="button" value="删除" id="addchildlanmu"  class="coolbg delbtn"/>
    排序:<input type="text" class="sort" value="{{sort2}}" size="3" maxlength="2"  />
    </form></td>
  </tr>
    <!-- END m2_block -->
  <!-- END m1_block -->
 </table>
<script>
$(function(){
	$("#addchildlanmu").bind("click",function(){
		if($("input[name='childlanmu']").val()==''){
			alert('名称不能为空');
			return false;
			}
		if($("input[name='childlanmuurl']").val()==''){
			alert('URL不能为空');

			return false;
			}		
		document.getElementById('addchildlanmuform').submit();
		});
	$("#addlanmu").bind("click",function(){
		if($("input[name='lanmu']").val()==''){
			alert('不能为空');
			return false;
			}
		document.getElementById('addlanmuform').submit();

		});

//删除后台菜单
	$(".delbtn").bind("click",function(){
		if(!confirm("确认删除?"))return;
		var obj=$(this);
		var valu=obj.prev().val();
		$.get("./",{
				'act':"ajax",
				'action':'delmenu',
				'id':valu
				},function(data){
					if(data=='1'){
							alert("删除成功！");
							obj.parent().parent().parent().remove();	
						}else{
							alert(data);
							}
			});
		})
//更新排序
	$(".sort").bind("blur",function(){
		var obj=$(this);
		var valu=obj.prev().prev().val();
		$.get("./",{
				'act':"ajax",
				'action':'updtsort',
				'id':valu,
				'sort':obj.val()
				},function(data){
					if(data==1){
						alert('排序更新成功！');
							
					}else{
						alert(data);		
							}
			});
		
		});
$("tr").bind("mouseover",function(){
	$(this).attr('bgcolor','#fcfdee');
	});
$("tr").bind("mouseout",function(){
	$(this).attr('bgcolor','#ffffff');
	});
});


</script>
</body>
</html>
